<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cardloop - STAYGO</title>
    <link rel="icon" type="image/png" href="../reveal-board/staygo-logo.png">
    <link rel="stylesheet" href="../../assets/css/site.css">
    <script defer src="../../assets/js/config.js"></script>
    <script defer src="../../assets/js/site.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Kanit:wght@700;800&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <a href="../../" class="logo-link">
                    <img src="../../games/reveal-board/staygo-logo.png" alt="Staygo" class="logo" />
                </a>
                
                <nav class="nav" aria-label="‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å">
                    <a href="../../#play" class="nav-link">Play</a>
                    <a href="../../#tools" class="nav-link active">Tools</a>
                    <a href="../../#watch" class="nav-link">Watch & Play</a>
                    <a href="../../#about" class="nav-link">About</a>
                </nav>

                <div class="header-actions">
                    <a href="https://www.youtube.com/@STAYGO" target="_blank" rel="noopener noreferrer" class="icon-button" aria-label="YouTube">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path>
                            <polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon>
                        </svg>
                    </a>
                    <button id="menuToggle" class="icon-button" aria-label="‡πÄ‡∏°‡∏ô‡∏π">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="3" y1="12" x2="21" y2="12"></line>
                            <line x1="3" y1="6" x2="21" y2="6"></line>
                            <line x1="3" y1="18" x2="21" y2="18"></line>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div id="mobileMenu" class="mobile-menu">
        <div class="mobile-menu-header">
            <span class="mobile-menu-title">‡πÄ‡∏°‡∏ô‡∏π</span>
            <button id="menuClose" class="icon-button" aria-label="‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
        <nav class="mobile-nav">
            <a href="../../#play" class="mobile-nav-link">Play</a>
            <a href="../../#tools" class="mobile-nav-link">Tools</a>
            <a href="../../#watch" class="mobile-nav-link">Watch & Play</a>
            <a href="../../#about" class="mobile-nav-link">About</a>
        </nav>
    </div>

    <main>
        <section class="section">
            <div class="container">
                <div class="team-header">
                    <h1 class="section-title">üé¥ Cardloop</h1>
                    <p class="team-description">‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° 4 ‡∏Ç‡πâ‡∏≠‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏ô‡∏∞‡πÄ‡∏Å‡∏°!</p>
                </div>

            <div class="cardloop-game">
                <!-- Stats -->
                <div class="cardloop-stats">
                    <div class="stat-card">
                        <div class="stat-label">‡∏£‡∏≠‡∏ö‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>
                        <div class="stat-value" id="currentRound">1</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà</div>
                        <div class="stat-value" id="currentQuestion">1</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">‡∏ä‡∏ô‡∏∞‡πÅ‡∏•‡πâ‡∏ß</div>
                        <div class="stat-value" id="totalWins">0</div>
                    </div>
                </div>

                <!-- Card Display -->
                <div class="card-display">
                    <div class="card-slot" id="card1">
                        <div class="card-back">?</div>
                    </div>
                    <div class="card-slot" id="card2">
                        <div class="card-back">?</div>
                    </div>
                    <div class="card-slot" id="card3">
                        <div class="card-back">?</div>
                    </div>
                    <div class="card-slot" id="card4">
                        <div class="card-back">?</div>
                    </div>
                </div>

                <!-- Question Area -->
                <div class="question-area">
                    <h2 class="question-text" id="questionText">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡∏°‡πà</h2>
                    <div class="answer-buttons" id="answerButtons">
                        <button class="answer-btn start-btn" id="startBtn">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
                    </div>
                </div>
            </div>
        </div>
    </section>
    </main>

    <!-- Win Modal -->
    <div class="modal-overlay" id="winModal">
        <div class="modal-content win-modal">
            <h2 class="modal-title">üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢!</h2>
            <p class="modal-text">‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡∏ó‡∏±‡πâ‡∏á 4 ‡∏Ç‡πâ‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô!</p>
            <p class="modal-rounds">‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <span id="winRounds"></span> ‡∏£‡∏≠‡∏ö</p>
            <button class="modal-btn" id="playAgainBtn">‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        </div>
    </div>

    <!-- Wrong Answer Modal -->
    <div class="modal-overlay" id="wrongModal">
        <div class="modal-content wrong-modal">
            <h2 class="modal-title">‚ùå ‡∏ú‡∏¥‡∏î!</h2>
            <p class="modal-text">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà 1</p>
            <button class="modal-btn wrong-btn" id="continueBtn">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
        </div>
    </div>

    <script>
        class CardloopGame {
            constructor() {
                this.deck = [];
                this.currentCard = null;
                this.previousCard = null;
                this.secondCard = null;
                this.question = 0; // 0 = not started, 1-4 = questions
                this.round = 1;
                this.totalWins = 0;
                this.cards = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
                this.suits = ['‚ô†', '‚ô£', '‚ô•', '‚ô¶'];
                this.redSuits = ['‚ô•', '‚ô¶'];
                this.blackSuits = ['‚ô†', '‚ô£'];
                
                this.init();
            }

            init() {
                this.createDeck();
                this.attachEventListeners();
                this.updateStats();
            }

            createDeck() {
                this.deck = [];
                for (let suit of this.suits) {
                    for (let card of this.cards) {
                        this.deck.push({ card, suit });
                    }
                }
                this.shuffleDeck();
            }

            shuffleDeck() {
                for (let i = this.deck.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [this.deck[i], this.deck[j]] = [this.deck[j], this.deck[i]];
                }
            }

            getCardValue(card) {
                const values = {
                    'A': 1, '2': 2, '3': 3, '4': 4, '5': 5, '6': 6, '7': 7,
                    '8': 8, '9': 9, '10': 10, 'J': 11, 'Q': 12, 'K': 13
                };
                return values[card];
            }

            drawCard() {
                if (this.deck.length === 0) {
                    this.createDeck();
                }
                return this.deck.pop();
            }

            startGame() {
                this.question = 1;
                this.currentCard = null;
                this.previousCard = null;
                this.secondCard = null;
                this.clearCards();
                this.showQuestion();
            }

            clearCards() {
                for (let i = 1; i <= 4; i++) {
                    const cardSlot = document.getElementById(`card${i}`);
                    cardSlot.innerHTML = '<div class="card-back">?</div>';
                    cardSlot.classList.remove('revealed');
                }
            }

            showQuestion() {
                this.updateStats();
                const questionText = document.getElementById('questionText');
                const answerButtons = document.getElementById('answerButtons');

                switch(this.question) {
                    case 1:
                        questionText.textContent = '‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà 1: ‡πÑ‡∏û‡πà‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏µ‡∏î‡∏≥?';
                        answerButtons.innerHTML = `
                            <button class="answer-btn red-btn" data-answer="red">‡πÅ‡∏î‡∏á ‚ô• ‚ô¶</button>
                            <button class="answer-btn black-btn" data-answer="black">‡∏î‡∏≥ ‚ô† ‚ô£</button>
                        `;
                        break;
                    case 2:
                        questionText.textContent = '‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà 2: ‡πÑ‡∏û‡πà‡πÉ‡∏ö‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏à‡∏∞‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤?';
                        answerButtons.innerHTML = `
                            <button class="answer-btn higher-btn" data-answer="higher">‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ ‚Üë</button>
                            <button class="answer-btn lower-btn" data-answer="lower">‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ ‚Üì</button>
                        `;
                        break;
                    case 3:
                        questionText.textContent = '‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà 3: ‡πÑ‡∏û‡πà‡πÉ‡∏ö‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏ô‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á?';
                        answerButtons.innerHTML = `
                            <button class="answer-btn inside-btn" data-answer="inside">‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á</button>
                            <button class="answer-btn outside-btn" data-answer="outside">‡∏ô‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á</button>
                        `;
                        break;
                    case 4:
                        questionText.textContent = '‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà 4: ‡πÑ‡∏û‡πà‡πÉ‡∏ö‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏´‡∏ô?';
                        answerButtons.innerHTML = `
                            <button class="answer-btn suit-btn" data-answer="‚ô†">‚ô†</button>
                            <button class="answer-btn suit-btn" data-answer="‚ô£">‚ô£</button>
                            <button class="answer-btn suit-btn suit-red" data-answer="‚ô•">‚ô•</button>
                            <button class="answer-btn suit-btn suit-red" data-answer="‚ô¶">‚ô¶</button>
                        `;
                        break;
                }

                this.attachAnswerListeners();
            }

            attachEventListeners() {
                document.getElementById('startBtn').addEventListener('click', () => this.startGame());
                document.getElementById('playAgainBtn').addEventListener('click', () => this.playAgain());
                document.getElementById('continueBtn').addEventListener('click', () => this.closeWrongModal());
            }

            attachAnswerListeners() {
                const buttons = document.querySelectorAll('.answer-btn');
                buttons.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const answer = e.target.dataset.answer;
                        this.handleAnswer(answer);
                    });
                });
            }

            handleAnswer(answer) {
                this.currentCard = this.drawCard();
                
                if (this.checkAnswer(answer, this.currentCard)) {
                    // Correct answer
                    this.revealCard(this.currentCard, this.question);
                    
                    if (this.question === 4) {
                        // Win!
                        setTimeout(() => this.showWinModal(), 800);
                    } else {
                        // Next question
                        if (this.question === 1) {
                            this.previousCard = this.currentCard;
                        } else if (this.question === 2) {
                            this.secondCard = this.currentCard;
                        }
                        
                        this.question++;
                        setTimeout(() => this.showQuestion(), 800);
                    }
                } else {
                    // Wrong answer - restart
                    this.revealCard(this.currentCard, this.question);
                    setTimeout(() => {
                        this.showWrongModal();
                    }, 800);
                }
            }

            checkAnswer(answer, card) {
                const isRed = this.redSuits.includes(card.suit);
                const cardValue = this.getCardValue(card.card);

                switch(this.question) {
                    case 1:
                        return (answer === 'red' && isRed) || (answer === 'black' && !isRed);
                    
                    case 2:
                        const prevValue = this.getCardValue(this.previousCard.card);
                        if (answer === 'higher') {
                            return cardValue > prevValue;
                        } else {
                            return cardValue < prevValue;
                        }
                    
                    case 3:
                        const val1 = this.getCardValue(this.previousCard.card);
                        const val2 = this.getCardValue(this.secondCard.card);
                        const min = Math.min(val1, val2);
                        const max = Math.max(val1, val2);
                        
                        if (answer === 'inside') {
                            return cardValue >= min && cardValue <= max;
                        } else {
                            return cardValue < min || cardValue > max;
                        }
                    
                    case 4:
                        return card.suit === answer;
                    
                    default:
                        return false;
                }
            }

            revealCard(card, position) {
                const cardSlot = document.getElementById(`card${position}`);
                const isRed = this.redSuits.includes(card.suit);
                const colorClass = isRed ? 'red' : 'black';
                
                cardSlot.innerHTML = `
                    <div class="card-front ${colorClass}">
                        <div class="card-value">${card.card}</div>
                        <div class="card-suit">${card.suit}</div>
                    </div>
                `;
                cardSlot.classList.add('revealed');
            }

            showWinModal() {
                this.totalWins++;
                document.getElementById('winRounds').textContent = this.round;
                document.getElementById('winModal').classList.add('active');
            }

            showWrongModal() {
                document.getElementById('wrongModal').classList.add('active');
            }

            closeWrongModal() {
                document.getElementById('wrongModal').classList.remove('active');
                this.round++;
                this.startGame();
            }

            playAgain() {
                document.getElementById('winModal').classList.remove('active');
                this.round = 1;
                this.updateStats();
                this.question = 0;
                this.clearCards();
                
                const questionText = document.getElementById('questionText');
                const answerButtons = document.getElementById('answerButtons');
                questionText.textContent = '‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡∏°‡πà';
                answerButtons.innerHTML = '<button class="answer-btn start-btn" id="startBtn">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>';
                
                document.getElementById('startBtn').addEventListener('click', () => this.startGame());
            }

            updateStats() {
                document.getElementById('currentRound').textContent = this.round;
                document.getElementById('currentQuestion').textContent = this.question || '-';
                document.getElementById('totalWins').textContent = this.totalWins;
            }
        }

        // Initialize game
        const game = new CardloopGame();
    </script>
</body>
</html>
